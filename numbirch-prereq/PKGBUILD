# Maintainer: Lawrence Murray <lawrence@indii.org>

pkgname=numbirch-prereq
pkgver=0.0.0
pkgrel=1
pkgdesc="Prerequisites for NumBirch, including custom jemalloc build and nvcc wrapper"
arch=('x86_64')
url="https://birch.sh"
license=('BSD')
makedepends=('gcc' 'autoconf' 'automake' 'libtool' 'libcurl-compat' 'gzip')
source=("$pkgname-$pkgver.tar.gz")
md5sums=('SKIP')

build() {
        cd "$srcdir/$pkgname-$pkgver"
        ./configure --prefix=/usr --disable-assert --disable-shared --enable-static --disable-initial-exec-tls --disable-doc --with-jemalloc-prefix=numbirch_ --with-install-suffix=_numbirch
        make
}

package() {
        cd "$srcdir/$pkgname-$pkgver"
        make DESTDIR="$pkgdir/" install
        install dpcpp_wrapper nvcc_wrapper $pkgdir/bin
}
